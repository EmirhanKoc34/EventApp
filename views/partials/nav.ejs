<nav class="navbar navbar-expand-lg custom-navbar" data-bs-theme="light">
    <div class="container">
        <div class="row w-100 align-items-center">
            <!-- Sol tarafta linkler -->
            <div class="col d-flex justify-content-start">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/galeri"><%= __('gallery') %></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/hakkimizda"><%= __('about') %></a>
                    </li>
                </ul>
            </div>

            <!-- Ortada logo -->
            <div class="col d-flex justify-content-center">
                <a class="navbar-brand" href="/anasayfa">
                    <img src="/images/logo.png" alt="Logo" width="50" height="50" class="d-inline-block align-text-top">
                </a>
            </div>

            <!-- Saƒü tarafta -->
            <div class="col d-flex justify-content-end align-items-center">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/panel"><%= __('events') %></a>
                    </li>
                    <li class="nav-item" id="etkinlikOnayPaneli">
                        <a class="nav-link" href="/etkinlikOnayPaneli"><%= __('eventsconfirmpage') %></a>
                    </li>
                    <li class="nav-item" id="etkinlikOlustur">
                        <a class="nav-link" href="/etkinlik-olustur"><%= __('createevent') %></a>
                    </li>
                </ul>

                <!-- Giri≈ü/√áƒ±kƒ±≈ü -->
                <% if (loggedin) { %>
                    <span class="ms-3">
                        <%= username %>
                    </span>
                    <a href="/logout" class="btn btn-dark ms-3"><%= __('logout') %></a>
                    <% } else { %>
                        <a href="/login" class="btn btn-dark ms-3"><%= __('login') %></a>
                        <% } %>

                            <!-- Dil Men√ºs√º -->
                            <div class="ms-3 position-relative" id="langDropdown">
                                <button onclick="toggleLangMenu()" class="btn btn-outline-secondary">üåê <%= __('lang') %></button>
                                <div id="langOptions" class="position-absolute bg-white border rounded mt-1 p-2 shadow"
                                    style="display:none; right:0; min-width:120px; z-index:999;">
                                    <div>
                                        <a href="#" onclick="setLang('tr')"
                                            class="d-block py-1 px-2 <%= lang === 'tr' ? 'fw-bold text-primary' : '' %>">üáπüá∑
                                            T√ºrk√ße</a>
                                        <a href="#" onclick="setLang('en')"
                                            class="d-block py-1 px-2 <%= lang === 'en' ? 'fw-bold text-primary' : '' %>">üá¨üáß
                                            English</a>
                                    </div>
                                </div>
                            </div>
            </div>
        </div>
    </div>
</nav>

<script>

    // Kullanƒ±cƒ± t√ºr√ºne g√∂re butonlarƒ± g√∂ster/gizle
    fetch("/isAdmin", {
        method: "POST",
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    }).then(data => {
        if (data.redirected) {
            document.getElementById('etkinlikOnayPaneli')?.remove();
        }
    });

    fetch("/isManager", {
        method: "POST",
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    }).then(data => {
        if (data.redirected) {
            document.getElementById('etkinlikOlustur')?.remove();
        }
    });

    // Dil se√ßimi
    function setLang(lang) {
        fetch('/update-lang', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ lang: lang })
        }).then(response => {
            if (response.ok) {
                window.location.reload();
            } else {
                console.log('Dil tercihi g√ºncellenemedi');
            }
        }).catch(error => console.error('Hata:', error));
    }

    // A√ßƒ±lƒ±r men√º kontrol√º
    function toggleLangMenu() {
        const menu = document.getElementById("langOptions");
        menu.style.display = (menu.style.display === "block") ? "none" : "block";
    }

    // Dƒ±≈ü tƒ±klama ile men√ºy√º kapat
    document.addEventListener("click", function (e) {
        const menu = document.getElementById("langOptions");
        const btn = document.getElementById("langDropdown");
        if (!btn.contains(e.target)) {
            menu.style.display = "none";
        }
    });
</script>