<nav class="navbar navbar-expand-lg custom-navbar" data-bs-theme="light">
    <div class="container">
        <div class="row w-100 align-items-center">
            <!-- Sol tarafta linkler -->
            <div class="col d-flex justify-content-start">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/galeri">Galeri</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/hakkimizda">HakkÄ±mÄ±zda</a>
                    </li>
                </ul>
            </div>

            <!-- Ortada logo -->
            <div class="col d-flex justify-content-center">
                <a class="navbar-brand" href="/anasayfa">
                    <img src="/images/logo.png" alt="Logo" width="50" height="50" class="d-inline-block align-text-top">
                </a>
            </div>

            <!-- SaÄŸ tarafta -->
            <div class="col d-flex justify-content-end align-items-center">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/panel">Etkinlikler</a>
                    </li>
                    <li class="nav-item" id="etkinlikOnayPaneli">
                        <a class="nav-link" href="/etkinlikOnayPaneli">Etkinlik Onay Paneli</a>
                    </li>
                    <li class="nav-item" id="etkinlikOlustur">
                        <a class="nav-link" href="/etkinlik-olustur">Etkinlik OluÅŸtur</a>
                    </li>
                </ul>

                <!-- GiriÅŸ/Ã‡Ä±kÄ±ÅŸ -->
                <% if (loggedin) { %>
                    <span class="ms-3">
                        <%= username %>
                    </span>
                    <a href="/logout" class="btn btn-dark ms-3">Ã‡Ä±kÄ±ÅŸ Yap</a>
                    <% } else { %>
                        <a href="/login" class="btn btn-dark ms-3">GiriÅŸ Yap</a>
                        <% } %>

                            <!-- Dil MenÃ¼sÃ¼ -->
                            <div class="ms-3 position-relative" id="langDropdown">
                                <button onclick="toggleLangMenu()" class="btn btn-outline-secondary">ğŸŒ Dil</button>
                                <div id="langOptions" class="position-absolute bg-white border rounded mt-1 p-2 shadow"
                                    style="display:none; right:0; min-width:120px; z-index:999;">
                                    <div>
                                        <a href="#" onclick="setLang('tr')"
                                            class="d-block py-1 px-2 <%= lang === 'tr' ? 'fw-bold text-primary' : '' %>">ğŸ‡¹ğŸ‡·
                                            TÃ¼rkÃ§e</a>
                                        <a href="#" onclick="setLang('en')"
                                            class="d-block py-1 px-2 <%= lang === 'en' ? 'fw-bold text-primary' : '' %>">ğŸ‡¬ğŸ‡§
                                            English</a>
                                    </div>
                                </div>
                            </div>
            </div>
        </div>
    </div>
</nav>

<script>
    // Admin/KulÃ¼p kontrolleri
    fetch("/isAdmin", {
        method: "POST",
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    }).then(data => {
        if (data.redirected) {
            document.getElementById('etkinlikOnayPaneli')?.remove();
        }
    });

    fetch("/isManager", {
        method: "POST",
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        }
    }).then(data => {
        if (data.redirected) {
            document.getElementById('etkinlikOlustur')?.remove();
        }
    });

    // Dil seÃ§imi
    function setLang(lang) {
        fetch('/update-lang', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ lang: lang })
        }).then(response => {
            if (response.ok) {
                window.location.reload();
            } else {
                console.log('Dil tercihi gÃ¼ncellenemedi');
            }
        }).catch(error => console.error('Hata:', error));
    }

    // AÃ§Ä±lÄ±r menÃ¼ kontrolÃ¼
    function toggleLangMenu() {
        const menu = document.getElementById("langOptions");
        menu.style.display = (menu.style.display === "block") ? "none" : "block";
    }

    // DÄ±ÅŸ tÄ±klama ile menÃ¼yÃ¼ kapat
    document.addEventListener("click", function (e) {
        const menu = document.getElementById("langOptions");
        const btn = document.getElementById("langDropdown");
        if (!btn.contains(e.target)) {
            menu.style.display = "none";
        }
    });
</script>